  <a target="_blank" rel="noopener" href="https://zxalive.com" class="special-link">新站点zxalive.com</a>
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"zxblog.eu.org","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="数据库和MySQL相关的所有知识点合集">
<meta property="og:type" content="article">
<meta property="og:title" content="数据库&amp;MySQL">
<meta property="og:url" content="https://zxblog.eu.org/posts/1c28/index.html">
<meta property="og:site_name" content="知行博客">
<meta property="og:description" content="数据库和MySQL相关的所有知识点合集">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://zxblog.eu.org/assets/eyZaX6Yuh8rV1Rm.png">
<meta property="og:image" content="https://zxblog.eu.org/assets/QaH6kjMVWPieG2N.png">
<meta property="og:image" content="https://zxblog.eu.org/assets/m6RkpfBMVv8sQzW.png">
<meta property="og:image" content="https://zxblog.eu.org/assets/UI5uP9wrA7MOfQZ.png">
<meta property="article:published_time" content="2021-11-17T18:11:55.000Z">
<meta property="article:modified_time" content="2024-08-18T10:14:29.242Z">
<meta property="article:author" content="zhangxin">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zxblog.eu.org/assets/eyZaX6Yuh8rV1Rm.png">


<link rel="canonical" href="https://zxblog.eu.org/posts/1c28/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://zxblog.eu.org/posts/1c28/","path":"posts/1c28/","title":"数据库&MySQL"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>数据库&MySQL | 知行博客</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">知行博客</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">新站点：zxalive.com</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93-amp-MySQL-%E7%9B%B8%E5%85%B3%E4%B9%A6%E7%B1%8D"><span class="nav-number">1.</span> <span class="nav-text">数据库&amp;MySQL-相关书籍</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93-amp-MySQL-%E8%B5%84%E6%BA%90"><span class="nav-number">2.</span> <span class="nav-text">数据库&amp;MySQL-资源</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MyBatis%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9C"><span class="nav-number">3.</span> <span class="nav-text">MyBatis批量操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E6%89%B9%E6%8F%92%E5%85%A5"><span class="nav-number">3.1.</span> <span class="nav-text">分批插入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mybatis%E6%89%B9%E9%87%8F%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE%E4%B8%89%E7%A7%8D%E6%96%B9%E6%B3%95%E6%95%88%E7%8E%87%E5%AF%B9%E6%AF%94"><span class="nav-number">3.2.</span> <span class="nav-text">mybatis批量更新数据三种方法效率对比</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MySQL-explain-%E8%AF%A6%E8%A7%A3"><span class="nav-number">4.</span> <span class="nav-text">MySQL-explain-详解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#id"><span class="nav-number">4.1.</span> <span class="nav-text">id</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#select-type"><span class="nav-number">4.2.</span> <span class="nav-text">select_type</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#table"><span class="nav-number">4.3.</span> <span class="nav-text">table</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#type-%E9%9D%9E%E5%B8%B8%E9%87%8D%E8%A6%81"><span class="nav-number">4.4.</span> <span class="nav-text">type(非常重要)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#possible-keys"><span class="nav-number">4.5.</span> <span class="nav-text">possible_keys</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#key-%E9%9D%9E%E5%B8%B8%E9%87%8D%E8%A6%81"><span class="nav-number">4.6.</span> <span class="nav-text">key(非常重要)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#key-len"><span class="nav-number">4.7.</span> <span class="nav-text">key_len</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ref"><span class="nav-number">4.8.</span> <span class="nav-text">ref</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rows"><span class="nav-number">4.9.</span> <span class="nav-text">rows</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Extra"><span class="nav-number">4.10.</span> <span class="nav-text">Extra</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#sql%E7%A4%BA%E4%BE%8B"><span class="nav-number">5.</span> <span class="nav-text">sql示例</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BB%BA%E8%A1%A8"><span class="nav-number">5.1.</span> <span class="nav-text">建表</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E3%80%8AMySQL%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0"><span class="nav-number">6.</span> <span class="nav-text">《MySQL必知必会》读书笔记</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">6.1.</span> <span class="nav-text">常用命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DISTINCT%E5%92%8CGROUP-BY"><span class="nav-number">6.2.</span> <span class="nav-text">DISTINCT和GROUP BY</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LIMIT%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">6.3.</span> <span class="nav-text">LIMIT操作符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LIKE%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">6.4.</span> <span class="nav-text">LIKE操作符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A3%E5%88%99%E5%9F%BA%E6%9C%AC%E5%AD%97%E7%AC%A6%E5%8C%B9%E9%85%8D"><span class="nav-number">6.5.</span> <span class="nav-text">正则基本字符匹配</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OR%E5%8C%B9%E9%85%8D"><span class="nav-number">6.6.</span> <span class="nav-text">OR匹配</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E5%87%A0%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B9%8B%E4%B8%80"><span class="nav-number">6.7.</span> <span class="nav-text">匹配几个字符之一</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E8%8C%83%E5%9B%B4"><span class="nav-number">6.8.</span> <span class="nav-text">匹配范围</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6"><span class="nav-number">6.9.</span> <span class="nav-text">匹配特殊字符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E5%AD%97%E7%AC%A6%E7%B1%BB"><span class="nav-number">6.10.</span> <span class="nav-text">匹配字符类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E5%A4%9A%E4%B8%AA%E5%AE%9E%E4%BE%8B"><span class="nav-number">6.11.</span> <span class="nav-text">匹配多个实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9A%E4%BD%8D%E7%AC%A6"><span class="nav-number">6.12.</span> <span class="nav-text">定位符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B5%8B%E8%AF%95"><span class="nav-number">6.13.</span> <span class="nav-text">简单的正则表达式测试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8B%BC%E6%8E%A5-CONCAT"><span class="nav-number">6.14.</span> <span class="nav-text">拼接 CONCAT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6-x2F"><span class="nav-number">6.15.</span> <span class="nav-text">MySQL算术运算符(+ - * &#x2F;)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E8%AE%A1%E7%AE%97"><span class="nav-number">6.16.</span> <span class="nav-text">测试计算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="nav-number">6.17.</span> <span class="nav-text">字符串函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0"><span class="nav-number">6.18.</span> <span class="nav-text">日期时间函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E5%80%BC%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0"><span class="nav-number">6.19.</span> <span class="nav-text">数值处理函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD%E5%87%BD%E6%95%B0"><span class="nav-number">6.20.</span> <span class="nav-text">条件判断函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%87%BD%E6%95%B0"><span class="nav-number">6.21.</span> <span class="nav-text">系统信息函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0"><span class="nav-number">6.22.</span> <span class="nav-text">聚集函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%88%86%E7%BB%84"><span class="nav-number">6.23.</span> <span class="nav-text">数据分组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E8%BF%87%E6%BB%A4HAVING"><span class="nav-number">6.24.</span> <span class="nav-text">分组过滤HAVING</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SELECT%E5%AD%97%E5%8F%A5%E9%A1%BA%E5%BA%8F"><span class="nav-number">6.25.</span> <span class="nav-text">SELECT字句顺序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%81%9A%E4%B8%BA%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5%E4%BD%BF%E7%94%A8%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">6.26.</span> <span class="nav-text">做为计算字段使用子查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%A7%86%E5%9B%BE"><span class="nav-number">6.27.</span> <span class="nav-text">创建视图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8BCREATE-PROCEDURE"><span class="nav-number">6.28.</span> <span class="nav-text">创建存储过程CREATE PROCEDURE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%BD%BF%E7%94%A8%E5%8F%82%E6%95%B0"><span class="nav-number">6.29.</span> <span class="nav-text">存储过程使用参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BB%BA%E7%AB%8B%E6%99%BA%E8%83%BD%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E6%A1%88%E4%BE%8B"><span class="nav-number">6.30.</span> <span class="nav-text">建立智能存储过程案例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A3%80%E6%B5%8B%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">6.31.</span> <span class="nav-text">检测存储过程</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E3%80%8A%E9%AB%98%E6%80%A7%E8%83%BDMySQL%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0"><span class="nav-number">7.</span> <span class="nav-text">《高性能MySQL》读书笔记</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">zhangxin</p>
  <div class="site-description" itemprop="description">新站点：zxalive.com</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">267</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


  <a target="_blank" rel="noopener" href="https://zxalive.com" class="special-link">新站点zxalive.com</a>


    </div>

    <div class="main-inner post posts-expand">

  <a target="_blank" rel="noopener" href="https://zxalive.com" class="special-link">新站点zxalive.com</a>

  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zxblog.eu.org/posts/1c28/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="zhangxin">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知行博客">
      <meta itemprop="description" content="新站点：zxalive.com">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="数据库&MySQL | 知行博客">
      <meta itemprop="description" content="数据库和MySQL相关的所有知识点合集">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          数据库&MySQL
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-11-18 02:11:55" itemprop="dateCreated datePublished" datetime="2021-11-18T02:11:55+08:00">2021-11-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-18 18:14:29" itemprop="dateModified" datetime="2024-08-18T18:14:29+08:00">2024-08-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">Java开发</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>37k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>33 分钟</span>
    </span>
</div>

            <div class="post-description">数据库和MySQL相关的所有知识点合集</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="数据库-amp-MySQL-相关书籍"><a href="#数据库-amp-MySQL-相关书籍" class="headerlink" title="数据库&amp;MySQL-相关书籍"></a>数据库&amp;MySQL-相关书籍</h1><ul>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iBhPT087oxjc">SQL必知必会-4-电子版</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iQpbf087oz2h">MySQL技术内幕(第4版)</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/i1Tno087ovpg">MySQL必知必会-扫描版</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iY13a087oxgj">MySQL技术内幕 InnoDB存储引擎 第2版</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/i4JWU08aj7te">MySQL技术内幕InnoDB存储引擎-有附录</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iOC9g087p23g">高性能 MySQL 第三版</a></li>
<li><a target="_blank" rel="noopener" href="https://www.aliyundrive.com/s/S8qNWNnjkAq">深入浅出MySQL数据库开发优化与管理维护</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iVxIz089tcva">MySQL优化学习思维笔记.xmind</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/i7aub089tcod">MyBatis面试专题</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iPi7i089tcpe">MySQL55题答案</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iCqMt089tcqf">mysql面试专题</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iNFIb089tcsh">MySQL性能优化的21个最佳实践</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/i1gle089tcti">MySQL优化问题.xmind</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iVxIz089tcva">MySQL优化学习思维笔记.xmind</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iuytS08a3iyj">数据库原理-第5版</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/i85Sy08aokdg">MyBatis.xmind</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/itvah08riadc">Effective+MySQL之SQL语句最优化.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iUkoz08rhy3a">程序员的SQL金典.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iqBfy08ri1hc">高性能MySQL-第3版.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iKSdd08ri2ne">漫画数据库.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://www.aliyundrive.com/s/xU1JBVeDGzC">深入浅出MySQL++数据库开发、优化与管理维护.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iiYxE08ria1a">自己动手设计数据库_自己动手设计数据库.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/i1Wxg08rieoh">Head.First.SQL(中文版).pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/igNGk08rif4d">MySQL必知必会(文字版).pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/i7bDL08rifyd">MySQL技术内幕：SQL编程.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/ic8j408rii7e">MySQL技术内幕(第4版).pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/ijLw708riiob">MySQL技术内幕InnoDB存储引擎.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iIeWv08rikqf">MySQL技术内幕InnoDB存储引擎(第1版).pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/i50jd08rj6fg">MySQL王者晋级之路.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iw2xj08rikyd">MySQL性能调优与架构设计.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://www.aliyundrive.com/s/aRMTWtQczk5">Oracle数据库性能优化.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iZ8fe08rje6f">Oracle性能优化求生指南.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/iI2k408rimgh">SQL必知必会.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://www.aliyundrive.com/s/xU1JBVeDGzC">SQL查询的艺术.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://wws.lanzoub.com/i2HJ808rjnfi">SQL学习指南.pdf</a></li>
<li></li>
</ul>
<h1 id="数据库-amp-MySQL-资源"><a href="#数据库-amp-MySQL-资源" class="headerlink" title="数据库&amp;MySQL-资源"></a>数据库&amp;MySQL-资源</h1><ul>
<li><p><a target="_blank" rel="noopener" href="https://highperfmysql.com/">高性能MySQL官网</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/OnGaqyUpB58pC2rqqzIzgw">原理探究：详解一条SQL的执行过程</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/36Jaj79Y8BxFoDB3Bwe7mg">原理探究：MySQL的数据存在磁盘上到底长什么样</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/WMuxdG3ymNMWWDk1XhLwZQ">原理探究：数据库索引到底是什么</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/d7Zfat2fP6IX5DMKKtEIjQ">原理探究：为什么MySQL索引要用B+ tree</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/-mOOchaXx_pKI6qWhohEnA">原理探究：为什么用了索引，SQL查询还是慢</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/4K3borSZXt-yc5t5UJnJpQ">原理探究：数据库索引的原理和使用准则</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/iBnav_WPrX5vjR-NbdNeQg">原理探究：为什么你写的SQL那么慢</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/lyAFcnZIoyhACw78Nf9xQg">原理探究：count(1)和count(*)到底哪个效率高</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/7vN9Nf20NGnvLKALHw_O1Q">原理探究：为什么阿里规定超过三张表禁止join</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/aPVs9Jrk07KsXcXdPOpx5A">原理研究：什么是MySQL索引下推？</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/yflzIQFiNa3tDJm7U9P8ig">原理探究：为什么大公司后台数据库都要搞分库分表？</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/QBeyJz2gVq1p7wBxcY1Gfw">原理探究：MySQL不会丢失数据的奥秘就藏在这里</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/CCLsmKSsodtkz4iX84Cdig">原理探究：MySQL主从复制那些事儿</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/caBYeVtZvNzbSs4q-6710Q">实践应用：常见的SQL错误（不当）写法例析</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/hl11JYMwl30FsDVZ40CLVQ">实践应用：SQL优化的几个角度</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/hE2uKE2ffNCmeHLRn2KSTQ">实践应用：数据库、数据表设计规范例析</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/jl0j-T6XldN6Nq-jYoQ-gA">实践应用：梳理开发中常用的SQL优化途径</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/SPgtpfgv6bz2AfPa1CYYeQ">实践应用：先更新数据库还是先更新缓存？</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/EplL3kBx5vOXGDhDOP8NjQ">实践应用：百亿级数据分表后如何分页查</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/mnZT0Z5L6Hi6gRgEO1C9tg">实践应用：什么是SQL注入攻击</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/4K3borSZXt-yc5t5UJnJpQ">实践应用：用对这些场景下的数据库索引，领导说我有点东西</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/MA7FVeJDMg8WDJABiBWpBA">实践应用：一个遗留项目的SQL优化实战录</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/UYZZkrbAetgnPUjGa71fJA">实践应用：误删数据库后该如何恢复</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/eQKphrkPeN_-EcWIxETz9Q">实践应用：如何科学根治慢SQL？</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/MLvJsJuFAHHcllqvk1nVRQ">面试相关：面试官最爱的数据库索引连环问</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/aBboeqEphejICklAKLqS2Q">面试相关：30道保底的MySQL数据库面试题集合</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/WqM5mhnLOqZhcdzPLeWh5w">面试相关：数据库自增ID用完了会怎样</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/RDOKLnG7P1j5Ehu3EyrsCQ">面试相关：如何保证缓存和数据库的一致性问题？</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/8ddEzG-NzzFD35ehvbER7A">面试相关：面试官最爱的MySQL连环问</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/1VCC3i6ZCk7sb9kVRZ1czQ">面试相关：如何实现丝滑的数据库扩容</a></p>
</li>
</ul>
<h1 id="MyBatis批量操作"><a href="#MyBatis批量操作" class="headerlink" title="MyBatis批量操作"></a>MyBatis批量操作</h1><h2 id="分批插入"><a href="#分批插入" class="headerlink" title="分批插入"></a>分批插入</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//分批插入，一次插入的大小</span></span><br><span class="line"><span class="type">int</span> <span class="variable">limit</span> <span class="operator">=</span> <span class="number">500</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">listSize</span> <span class="operator">=</span> userList.size();</span><br><span class="line">List&lt;ConsoleUserSyncVO&gt; newList = Lists.newArrayList();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; listSize; i++)&#123;</span><br><span class="line">    <span class="comment">//分批次处理,循环将数据填入载体list</span></span><br><span class="line">    newList.add(consoleUserList.get(i));</span><br><span class="line">    <span class="comment">//临时存储newList达到要求或者达到最大量,进行批量操作</span></span><br><span class="line">    <span class="keyword">if</span>(limit==newList.size()||i==listSize-<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="comment">//调用批量插入</span></span><br><span class="line">        userDao.insertListUser(newList);</span><br><span class="line">        <span class="comment">//每次批量操作后,清空载体list,等待下次的数据填入</span></span><br><span class="line">        newList.clear();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="mybatis批量更新数据三种方法效率对比"><a href="#mybatis批量更新数据三种方法效率对比" class="headerlink" title="mybatis批量更新数据三种方法效率对比"></a>mybatis批量更新数据三种方法效率对比</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/q957967519/article/details/88669552">原作链接</a></p>
<p>实现方式有三种</p>
<ul>
<li>for循环通过循环传过来的参数集合，循环出N条sql，<br>注意此方法需要在db链接url后面带一个参数  &amp;allowMultiQueries&#x3D;true<br>即：  jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;mysqlTest?characterEncoding&#x3D;utf-8&amp;allowMultiQueries&#x3D;true</li>
<li>用mysql的case when 条件判断变相的进行批量更新</li>
<li>用ON DUPLICATE KEY UPDATE进行批量更新</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 批量更新第一种方法，通过接收传进来的参数list进行循环着组装sql --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateBatch&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.util.List&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">item</span>=<span class="string">&quot;item&quot;</span> <span class="attr">index</span>=<span class="string">&quot;index&quot;</span> <span class="attr">open</span>=<span class="string">&quot;&quot;</span> <span class="attr">close</span>=<span class="string">&quot;&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;;&quot;</span>&gt;</span></span><br><span class="line">    update standard_relation</span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;item.standardFromUuid != null&quot;</span>&gt;</span></span><br><span class="line">        standard_from_uuid = #&#123;item.standardFromUuid,jdbcType=VARCHAR&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;item.standardToUuid != null&quot;</span>&gt;</span></span><br><span class="line">        standard_to_uuid = #&#123;item.standardToUuid,jdbcType=VARCHAR&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;item.gmtModified != null&quot;</span>&gt;</span></span><br><span class="line">        gmt_modified = #&#123;item.gmtModified,jdbcType=TIMESTAMP&#125;,</span><br><span class="line">      <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    where id = #&#123;item.id,jdbcType=BIGINT&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 批量更新第二种方法，通过 case when语句变相的进行批量更新 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateBatch&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.util.List&quot;</span>&gt;</span></span><br><span class="line">  update standard_relation</span><br><span class="line">  <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">&quot;set&quot;</span> <span class="attr">suffixOverrides</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">&quot;standard_from_uuid =case&quot;</span> <span class="attr">suffix</span>=<span class="string">&quot;end,&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">item</span>=<span class="string">&quot;i&quot;</span> <span class="attr">index</span>=<span class="string">&quot;index&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;i.standardFromUuid!=null&quot;</span>&gt;</span></span><br><span class="line">          when id=#&#123;i.id&#125; then #&#123;i.standardFromUuid&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">&quot;standard_to_uuid =case&quot;</span> <span class="attr">suffix</span>=<span class="string">&quot;end,&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">item</span>=<span class="string">&quot;i&quot;</span> <span class="attr">index</span>=<span class="string">&quot;index&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;i.standardToUuid!=null&quot;</span>&gt;</span></span><br><span class="line">          when id=#&#123;i.id&#125; then #&#123;i.standardToUuid&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">&quot;gmt_modified =case&quot;</span> <span class="attr">suffix</span>=<span class="string">&quot;end,&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">item</span>=<span class="string">&quot;i&quot;</span> <span class="attr">index</span>=<span class="string">&quot;index&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;i.gmtModified!=null&quot;</span>&gt;</span></span><br><span class="line">          when id=#&#123;i.id&#125; then #&#123;i.gmtModified&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line">  where</span><br><span class="line">  <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;or&quot;</span> <span class="attr">item</span>=<span class="string">&quot;i&quot;</span> <span class="attr">index</span>=<span class="string">&quot;index&quot;</span>&gt;</span></span><br><span class="line">    id=#&#123;i.id&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 批量更新第三种方法，用ON DUPLICATE KEY UPDATE --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;updateBatch&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;java.util.List&quot;</span>&gt;</span></span><br><span class="line">  insert into standard_relation(id,relation_type, standard_from_uuid, standard_to_uuid, relation_score, stat, last_process_id, is_deleted, gmt_created, gmt_modified,relation_desc)</span><br><span class="line">  VALUES</span><br><span class="line">  <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">item</span>=<span class="string">&quot;item&quot;</span> <span class="attr">index</span>=<span class="string">&quot;index&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">    (#&#123;item.id,jdbcType=BIGINT&#125;,</span><br><span class="line">    #&#123;item.relationType,jdbcType=VARCHAR&#125;, </span><br><span class="line">    #&#123;item.standardFromUuid,jdbcType=VARCHAR&#125;,</span><br><span class="line">    #&#123;item.standardToUuid,jdbcType=VARCHAR&#125;, </span><br><span class="line">    #&#123;item.relationScore,jdbcType=DECIMAL&#125;, </span><br><span class="line">    #&#123;item.stat,jdbcType=TINYINT&#125;,</span><br><span class="line">    #&#123;item.lastProcessId,jdbcType=BIGINT&#125;, </span><br><span class="line">    #&#123;item.isDeleted,jdbcType=TINYINT&#125;, </span><br><span class="line">    #&#123;item.gmtCreated,jdbcType=TIMESTAMP&#125;,</span><br><span class="line">    #&#123;item.gmtModified,jdbcType=TIMESTAMP&#125;,</span><br><span class="line">    #&#123;item.relationDesc,jdbcType=VARCHAR&#125;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">  ON DUPLICATE KEY UPDATE</span><br><span class="line">  id=VALUES(id),</span><br><span class="line">  relation_type = VALUES(relation_type),</span><br><span class="line">  standard_from_uuid = VALUES(standard_from_uuid),</span><br><span class="line">  standard_to_uuid = VALUES(standard_to_uuid),</span><br><span class="line">  relation_score = VALUES(relation_score),</span><br><span class="line">  stat = VALUES(stat),</span><br><span class="line">  last_process_id = VALUES(last_process_id),</span><br><span class="line">  is_deleted = VALUES(is_deleted),</span><br><span class="line">  gmt_created = VALUES(gmt_created),</span><br><span class="line">  gmt_modified = VALUES(gmt_modified),</span><br><span class="line">  relation_desc = VALUES(relation_desc)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateStandardRelations</span><span class="params">()</span> &#123;</span><br><span class="line">  List&lt;StandardRelation&gt; list=standardRelationMapper.selectByStandardUuid(<span class="string">&quot;xiemingjieupdate&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span>(StandardRelation tmp:list)&#123;</span><br><span class="line">    tmp.setStandardFromUuid(tmp.getStandardFromUuid()+<span class="string">&quot;update&quot;</span>);</span><br><span class="line">    tmp.setStandardToUuid(tmp.getStandardToUuid()+<span class="string">&quot;update&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">long</span> begin=System.currentTimeMillis();</span><br><span class="line">  standardRelationManager.updateBatch(list);</span><br><span class="line">  <span class="type">long</span> end=System.currentTimeMillis();</span><br><span class="line">  System.out.print(<span class="string">&quot;当前的批量更新的方法用时&quot;</span>+(end-begin)+<span class="string">&quot;ms&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../../assets/eyZaX6Yuh8rV1Rm.png"></p>
<p>sql语句for循环效率其实相当高的，因为它仅仅有一个循环体，只不过最后update语句比较多，量大了就有可能造成sql阻塞。</p>
<p>case when虽然最后只会有一条更新语句，但是xml中的循环体有点多，每一个case when 都要循环一遍list集合，所以大批量拼sql的时候会比较慢，所以效率问题严重。使用的时候建议分批插入。</p>
<p>duplicate key update可以看出来是最快的，但是一般大公司都禁用，公司一般都禁止使用replace into和INSERT INTO … ON DUPLICATE KEY UPDATE，这种sql有可能会造成数据丢失和主从上表的自增id值不一致。而且用这个更新时，记得一定要加上id，而且values（）括号里面放的是数据库字段，不是java对象的属性字段。</p>
<p><img src="/../../assets/QaH6kjMVWPieG2N.png"></p>
<p>根据效率，安全方面综合考虑，选择适合的很重要。</p>
<h1 id="MySQL-explain-详解"><a href="#MySQL-explain-详解" class="headerlink" title="MySQL-explain-详解"></a>MySQL-explain-详解</h1><p><code>explain select * from servers;</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">+----+-------------+---------+------+---------------+------+---------+------+------+-------+</span><br><span class="line">| id | select_type | table   | type | possible_keys | key  | key_len | ref  | rows | Extra |</span><br><span class="line">+----+-------------+---------+------+---------------+------+---------+------+------+-------+</span><br><span class="line">|  1 | SIMPLE      | servers | ALL  | NULL          | NULL | NULL    | NULL |    1 | NULL  |</span><br><span class="line">+----+-------------+---------+------+---------------+------+---------+------+------+-------+</span><br><span class="line">row in set (0.03 sec)</span><br></pre></td></tr></table></figure>

<p><strong>expain出来的信息有10列</strong></p>
<ul>
<li><code>id</code> 选择标识符</li>
<li><code>select_type</code> 表示查询的类型</li>
<li><code>table</code> 输出结果集的表</li>
<li><code>type</code> 表示表的连接类型</li>
<li><code>possible_keys</code> 表示查询时，可能使用的索引</li>
<li><code>key</code> 表示实际使用的索引</li>
<li><code>key_len</code> 索引字段的长度</li>
<li><code>ref</code> 列与索引的比较</li>
<li><code>rows</code> 扫描出的行数(估算的行数)</li>
<li><code>Extra</code> 执行情况的描述和说明</li>
</ul>
<h2 id="id"><a href="#id" class="headerlink" title="id"></a>id</h2><p>SQL执行的成功的标识，SQL从大到小的执行。</p>
<ol>
<li>id相同时，执行顺序由上至下，内存会认为三个表，乘积小的先执行<br>比如三个表：t3-t4-t5<br>：t3-t3-t4</li>
<li>如果是子查询，id的序号会递增，id值越大优先级越高，越先被执行</li>
<li>id如果相同，可以认为是一组，从上往下顺序执行；在所有组中，id值越大，优先级越高，越先执行</li>
</ol>
<p><code>explain select * from (select * from ( select * from t3 where id=123) a) b;</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+</span><br><span class="line">| id | select_type | table      | type   | possible_keys     | key     | key_len | ref  | rows | Extra |</span><br><span class="line">+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+</span><br><span class="line">|  1 | PRIMARY     | &lt;derived2&gt; | system | NULL              | NULL    | NULL    | NULL |    1 |       |</span><br><span class="line">|  2 | DERIVED     | &lt;derived3&gt; | system | NULL              | NULL    | NULL    | NULL |    1 |       |</span><br><span class="line">|  3 | DERIVED     | t3         | const  | PRIMARY,idx_t3_id | PRIMARY | 4       |      |    1 |       |</span><br><span class="line">+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+</span><br></pre></td></tr></table></figure>

<p>很显然这条SQL是从里向外的执行,就是从id&#x3D;3 向上执行.</p>
<h2 id="select-type"><a href="#select-type" class="headerlink" title="select_type"></a>select_type</h2><ol>
<li><p><strong>SIMPLE</strong></p>
<p>最简单的select(不使用UNION或子查询等) 例如:</p>
<p><code>explain select * from t3 where id=123;</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">+----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------+</span><br><span class="line">| id | select_type | table | type  | possible_keys     | key     | key_len | ref   | rows | Extra |</span><br><span class="line">+----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------+</span><br><span class="line">|  1 | SIMPLE      | t3    | const | PRIMARY,idx_t3_id | PRIMARY | 4       | const |    1 |       |</span><br><span class="line">+----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------+</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>PRIMARY</strong></p>
<p>最外层的select，主查询，例如：</p>
<p><code>explain select * from (select * from t3 where id=123) a ;</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+</span><br><span class="line">| id | select_type | table      | type   | possible_keys     | key     | key_len | ref  | rows | Extra |</span><br><span class="line">+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+</span><br><span class="line">|  1 | PRIMARY     | &lt;derived2&gt; | system | NULL              | NULL    | NULL    | NULL |    1 |       |</span><br><span class="line">|  2 | DERIVED     | t3         | const  | PRIMARY,idx_t3_id | PRIMARY | 4       |      |    1 |       |</span><br><span class="line">+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>UNION</strong></p>
<p>UNION中的第二个或后面的select语句，例如：</p>
<p><code>explain select * from t3 where id=123 union all select * from t3 ;</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">+----+--------------+------------+-------+-------------------+---------+---------+-------+------+-------+</span><br><span class="line">| id | select_type  | table      | type  | possible_keys     | key     | key_len | ref   | rows | Extra |</span><br><span class="line">+----+--------------+------------+-------+-------------------+---------+---------+-------+------+-------+</span><br><span class="line">|  1 | PRIMARY      | t3         | const | PRIMARY,idx_t3_id | PRIMARY | 4       | const |    1 |       |</span><br><span class="line">|  2 | UNION        | t3         | ALL   | NULL              | NULL    | NULL    | NULL  | 1000 |       |</span><br><span class="line">|NULL | UNION RESULT | &lt;union1,2&gt; | ALL   | NULL              | NULL    | NULL    | NULL  | NULL |       |</span><br><span class="line">+----+--------------+------------+-------+-------------------+---------+---------+-------+------+-------+</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>DEPENDENT UNION</strong></p>
<p>UNION中的第二个或后面的select语句，取决于外面的查询，例如：</p>
<p><code>explain select * from t3 where id in (select id from t3 where id=123 union all select id from t3) ;</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">+----+--------------------+------------+--------+-------------------+---------+---------+-------+------+--------------------------+</span><br><span class="line">| id | select_type        | table      | type   | possible_keys     | key     | key_len | ref   | rows | Extra                    |</span><br><span class="line">+----+--------------------+------------+--------+-------------------+---------+---------+-------+------+--------------------------+</span><br><span class="line">|  1 | PRIMARY            | t3         | ALL    | NULL              | NULL    | NULL    | NULL  | 1000 | Using where              |</span><br><span class="line">|  2 | DEPENDENT SUBQUERY | t3         | const  | PRIMARY,idx_t3_id | PRIMARY | 4       | const |    1 | Using index              |</span><br><span class="line">|  3 | DEPENDENT UNION    | t3         | eq_ref | PRIMARY,idx_t3_id | PRIMARY | 4       | func  |    1 | Using where; Using index |</span><br><span class="line">|NULL | UNION RESULT       | &lt;union2,3&gt; | ALL    | NULL              | NULL    | NULL    | NULL  | NULL |                          |</span><br><span class="line">+----+--------------------+------------+--------+-------------------+---------+---------+-------+------+--------------------------+</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>UNION RESULT</strong></p>
<p>UNION的结果，union语句中第二个select开始后面所有select</p>
</li>
<li><p><strong>SUBQUERY</strong></p>
<p>非最外层的select，在子查询中第一个select，例如：</p>
<p><code>explain select * from t3 where id = (select id from t3 where id=123 ) ;</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">+----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------------+</span><br><span class="line">| id | select_type | table | type  | possible_keys     | key     | key_len | ref   | rows | Extra       |</span><br><span class="line">+----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------------+</span><br><span class="line">|  1 | PRIMARY     | t3    | const | PRIMARY,idx_t3_id | PRIMARY | 4       | const |    1 |             |</span><br><span class="line">|  2 | SUBQUERY    | t3    | const | PRIMARY,idx_t3_id | PRIMARY | 4       |       |    1 | Using index |</span><br><span class="line">+----+-------------+-------+-------+-------------------+---------+---------+-------+------+-------------+</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>DEPENDENT SUBQUERY</strong></p>
<p>子查询中的第一个select，取决于外面的查询，例如：</p>
<p><code>explain select id from t3 where id in (select id from t3 where id=123 )  ;</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">+----+--------------------+-------+-------+-------------------+---------+---------+-------+------+--------------------------+</span><br><span class="line">| id | select_type        | table | type  | possible_keys     | key     | key_len | ref   | rows | Extra                    |</span><br><span class="line">+----+--------------------+-------+-------+-------------------+---------+---------+-------+------+--------------------------+</span><br><span class="line">|  1 | PRIMARY            | t3    | index | NULL              | PRIMARY | 4       | NULL  | 1000 | Using where; Using index |</span><br><span class="line">|  2 | DEPENDENT SUBQUERY | t3    | const | PRIMARY,idx_t3_id | PRIMARY | 4       | const |    1 | Using index              |</span><br><span class="line">+----+--------------------+-------+-------+-------------------+---------+---------+-------+------+--------------------------+</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>DERIVED</strong></p>
<p>派生表的select(from子句的子查询)</p>
<p><code>explain select * from (select * from t3 where id=123) a ;</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+</span><br><span class="line">| id | select_type | table      | type   | possible_keys     | key     | key_len | ref  | rows | Extra |</span><br><span class="line">+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+</span><br><span class="line">|  1 | PRIMARY     | &lt;derived2&gt; | system | NULL              | NULL    | NULL    | NULL |    1 |       |</span><br><span class="line">|  2 | DERIVED     | t3         | const  | PRIMARY,idx_t3_id | PRIMARY | 4       |      |    1 |       |</span><br><span class="line">+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+</span><br></pre></td></tr></table></figure>
</li>
<li><p>UNCACHEABLE SUBQUERY</p>
<p>一个子查询的结果不能被缓存，必须重新评估外链接的第一行</p>
</li>
</ol>
<h2 id="table"><a href="#table" class="headerlink" title="table"></a>table</h2><p>代表表名。有时不是真实的表名,看到的是&lt;derived**X**&gt;(数字X是第几步执行的结果)</p>
<p><code>explain select * from (select * from ( select * from t3 where id=123) a) b;</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+</span><br><span class="line">| id | select_type | table      | type   | possible_keys     | key     | key_len | ref  | rows | Extra |</span><br><span class="line">+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+</span><br><span class="line">|  1 | PRIMARY     | &lt;derived2&gt; | system | NULL              | NULL    | NULL    | NULL |    1 |       |</span><br><span class="line">|  2 | DERIVED     | &lt;derived3&gt; | system | NULL              | NULL    | NULL    | NULL |    1 |       |</span><br><span class="line">|  3 | DERIVED     | t3         | const  | PRIMARY,idx_t3_id | PRIMARY | 4       |      |    1 |       |</span><br><span class="line">+----+-------------+------------+--------+-------------------+---------+---------+------+------+-------+</span><br></pre></td></tr></table></figure>

<h2 id="type-非常重要"><a href="#type-非常重要" class="headerlink" title="type(非常重要)"></a>type(非常重要)</h2><p>使用了哪种类别，是否使用索引.</p>
<p>const、eq_reg、ref、range、indexhe、ALL（从左到右，性能从好到差）</p>
<ul>
<li>ALL： MySQL进行全表扫描。</li>
<li>index：全索引扫描。index与ALL区别为index类型只遍历索引树</li>
<li>range：只检索给定范围的行，使用一个索引来选择行</li>
<li>ref：表示上述表的连接匹配条件，即哪些列或常量被用于查找索引列上的值</li>
<li>eq_ref： 类似ref，区别就在使用的索引是唯一索引，对于每个索引键值，表中只有一条记录匹配，简单来说，就是多表连接中使用primary key或者 unique key作为关联条件</li>
<li>const、system: 当MySQL对查询某部分进行优化，并转换为一个常量时，使用这些类型访问。如将主键置于where列表中，MySQL就能将该查询转换为一个常量,system是const类型的特例，当查询的表只有一行的情况下，使用system</li>
<li>NULL: MySQL在优化过程中分解语句，执行时甚至不用访问表或索引，例如从一个索引列里选取最小值可以通过单独索引查找完成。</li>
</ul>
<h2 id="possible-keys"><a href="#possible-keys" class="headerlink" title="possible_keys"></a>possible_keys</h2><p><strong>指出MySQL能使用哪个索引在表中找到记录，查询涉及到的字段上若存在索引，则该索引将被列出，但不一定被查询使用（该查询可以利用的索引，如果没有任何索引显示 null）</strong></p>
<p>该列完全独立于EXPLAIN输出所示的表的次序。这意味着在possible_keys中的某些键实际上不能按生成的表次序使用。<br>如果该列是NULL，则没有相关的索引。在这种情况下，可以通过检查WHERE子句看是否它引用某些列或适合索引的列来提高你的查询性能。如果是这样，创造一个适当的索引并且再次用EXPLAIN检查查询</p>
<h2 id="key-非常重要"><a href="#key-非常重要" class="headerlink" title="key(非常重要)"></a>key(非常重要)</h2><p><strong>key列显示MySQL实际决定使用的键（索引），必然包含在possible_keys中</strong></p>
<p>如果没有选择索引，键是NULL。要想强制MySQL使用或忽视possible_keys列中的索引，在查询中使用FORCE INDEX、USE INDEX或者IGNORE INDEX。</p>
<h2 id="key-len"><a href="#key-len" class="headerlink" title="key_len"></a>key_len</h2><p><strong>表示索引中使用的字节数，可通过该列计算查询中使用的索引的长度（key_len显示的值为索引字段的最大可能长度，并非实际使用长度，即key_len是根据表定义计算而得，不是通过表内检索出的）</strong></p>
<p>在不损失精确性的情况下，长度越短越好</p>
<h2 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h2><p>表示上述表的连接匹配条件，即哪些列或常量被用于查找索引列上的值。</p>
<h2 id="rows"><a href="#rows" class="headerlink" title="rows"></a>rows</h2><p>rows列显示MySQL认为它执行查询时必须检查的行数。</p>
<h2 id="Extra"><a href="#Extra" class="headerlink" title="Extra"></a>Extra</h2><p><strong>该列包含MySQL解决查询的详细信息,有以下几种情况：</strong></p>
<ul>
<li><p>Using where:不用读取表中所有信息，仅通过索引就可以获取所需数据，这发生在对表的全部的请求列都是同一个索引的部分的时候，表示mysql服务器将在存储引擎检索行后再进行过滤</p>
</li>
<li><p>Using temporary：表示MySQL需要使用临时表来存储结果集，常见于排序和分组查询，常见 group by ; order by</p>
</li>
<li><p>Using filesort：当Query中包含 order by 操作，而且无法利用索引完成的排序操作称为“文件排序”</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 测试Extra的filesort</span></span><br><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> name;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Using join buffer：改值强调了在获取连接条件时没有使用索引，并且需要连接缓冲区来存储中间结果。如果出现了这个值，那应该注意，根据查询的具体情况可能需要添加索引来改进能。</p>
</li>
<li><p>Impossible where：这个值强调了where语句会导致没有符合条件的行（通过收集统计信息不可能存在结果）。</p>
</li>
<li><p>Select tables optimized away：这个值意味着仅通过使用索引，优化器可能仅从聚合函数结果中返回一行</p>
</li>
<li><p>No tables used：Query语句中使用from dual 或不含任何from子句</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- explain select now() from dual;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>总结：</strong><br>• EXPLAIN不会告诉你关于触发器、存储过程的信息或用户自定义函数对查询的影响情况<br>• EXPLAIN不考虑各种Cache<br>• EXPLAIN不能显示MySQL在执行查询时所作的优化工作<br>• 部分统计信息是估算的，并非精确值<br>• EXPALIN只能解释SELECT操作，其他操作要重写为SELECT后查看执行计划。**</p>
<p>通过收集统计信息不可能存在结果</p>
<h1 id="sql示例"><a href="#sql示例" class="headerlink" title="sql示例"></a>sql示例</h1><h2 id="建表"><a href="#建表" class="headerlink" title="建表"></a>建表</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SET</span> NAMES utf8mb4;</span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for t_trans_submit</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `t_trans_submit`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `t_trans_submit`  (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;主键&#x27;</span>,</span><br><span class="line">  `cif_id` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;cifId&#x27;</span>,</span><br><span class="line">  `pay_acc` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;payAcc&#x27;</span>,</span><br><span class="line">  `trans_type` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankId&#x27;</span>,</span><br><span class="line">  `pay_acc_name` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankSingleLimit&#x27;</span>,</span><br><span class="line">  `acc_op_bank` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `rec_acc` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `rec_acc_name` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `rec_bank` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `amt` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `us` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `rec_phone` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `pay_stt` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `trans_way` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `amt_c_n` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `fee` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `rem` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `remark` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `is_order` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `order_time` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `order_date` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `order_phone` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `trans_flow` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `submit_time` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  `trans_method` <span class="type">varchar</span>(<span class="number">256</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;openBankDayLimit&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">1541611347942412290</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">DYNAMIC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of t_trans_submit</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `t_trans_submit` <span class="keyword">VALUES</span> (<span class="number">1541453811006631937</span>, <span class="string">&#x27;8080808080&#x27;</span>, <span class="string">&#x27;1122334455667799&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;1122334455667788&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;100000&#x27;</span>, <span class="string">&#x27;转账用途&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;转账方式&#x27;</span>, <span class="string">&#x27;转账大写金额&#x27;</span>, <span class="string">&#x27;附言&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;备注&#x27;</span>, <span class="string">&#x27;预约处理&#x27;</span>, <span class="string">&#x27;预约时间&#x27;</span>, <span class="string">&#x27;2025-12-12&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;1656346202026&#x27;</span>, <span class="string">&#x27;2022-06-28 12:10:02&#x27;</span>, <span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `t_trans_submit` <span class="keyword">VALUES</span> (<span class="number">1541453912416514050</span>, <span class="string">&#x27;8080808080&#x27;</span>, <span class="string">&#x27;1122334455667799&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;1122334455667788&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;100000&#x27;</span>, <span class="string">&#x27;转账用途&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;转账方式&#x27;</span>, <span class="string">&#x27;转账大写金额&#x27;</span>, <span class="string">&#x27;附言&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;备注&#x27;</span>, <span class="string">&#x27;预约处理&#x27;</span>, <span class="string">&#x27;预约时间&#x27;</span>, <span class="string">&#x27;2025-12-12&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;1656346226205&#x27;</span>, <span class="string">&#x27;2022-06-28 12:10:26&#x27;</span>, <span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `t_trans_submit` <span class="keyword">VALUES</span> (<span class="number">1541453919748157442</span>, <span class="string">&#x27;8080808080&#x27;</span>, <span class="string">&#x27;1122334455667799&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;1122334455667788&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;100000&#x27;</span>, <span class="string">&#x27;转账用途&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;转账方式&#x27;</span>, <span class="string">&#x27;转账大写金额&#x27;</span>, <span class="string">&#x27;附言&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;备注&#x27;</span>, <span class="string">&#x27;预约处理&#x27;</span>, <span class="string">&#x27;预约时间&#x27;</span>, <span class="string">&#x27;2025-12-12&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;1656346227947&#x27;</span>, <span class="string">&#x27;2022-06-28 12:10:27&#x27;</span>, <span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `t_trans_submit` <span class="keyword">VALUES</span> (<span class="number">1541453925137838081</span>, <span class="string">&#x27;8080808080&#x27;</span>, <span class="string">&#x27;1122334455667799&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;1122334455667788&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;100000&#x27;</span>, <span class="string">&#x27;转账用途&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;转账方式&#x27;</span>, <span class="string">&#x27;转账大写金额&#x27;</span>, <span class="string">&#x27;附言&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;备注&#x27;</span>, <span class="string">&#x27;预约处理&#x27;</span>, <span class="string">&#x27;预约时间&#x27;</span>, <span class="string">&#x27;2025-12-12&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;1656346229237&#x27;</span>, <span class="string">&#x27;2022-06-28 12:10:29&#x27;</span>, <span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `t_trans_submit` <span class="keyword">VALUES</span> (<span class="number">1541453930280054786</span>, <span class="string">&#x27;8080808080&#x27;</span>, <span class="string">&#x27;1122334455667799&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;1122334455667788&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;100000&#x27;</span>, <span class="string">&#x27;转账用途&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;转账方式&#x27;</span>, <span class="string">&#x27;转账大写金额&#x27;</span>, <span class="string">&#x27;附言&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;备注&#x27;</span>, <span class="string">&#x27;预约处理&#x27;</span>, <span class="string">&#x27;预约时间&#x27;</span>, <span class="string">&#x27;2025-12-12&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;1656346230463&#x27;</span>, <span class="string">&#x27;2022-06-28 12:10:30&#x27;</span>, <span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `t_trans_submit` <span class="keyword">VALUES</span> (<span class="number">1541453935158030337</span>, <span class="string">&#x27;8080808080&#x27;</span>, <span class="string">&#x27;1122334455667799&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;1122334455667788&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;100000&#x27;</span>, <span class="string">&#x27;转账用途&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;转账方式&#x27;</span>, <span class="string">&#x27;转账大写金额&#x27;</span>, <span class="string">&#x27;附言&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;备注&#x27;</span>, <span class="string">&#x27;预约处理&#x27;</span>, <span class="string">&#x27;预约时间&#x27;</span>, <span class="string">&#x27;2025-12-12&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;1656346231627&#x27;</span>, <span class="string">&#x27;2022-06-28 12:10:31&#x27;</span>, <span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `t_trans_submit` <span class="keyword">VALUES</span> (<span class="number">1541453940010840065</span>, <span class="string">&#x27;8080808080&#x27;</span>, <span class="string">&#x27;1122334455667799&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;1122334455667788&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;100000&#x27;</span>, <span class="string">&#x27;转账用途&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;转账方式&#x27;</span>, <span class="string">&#x27;转账大写金额&#x27;</span>, <span class="string">&#x27;附言&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;备注&#x27;</span>, <span class="string">&#x27;预约处理&#x27;</span>, <span class="string">&#x27;预约时间&#x27;</span>, <span class="string">&#x27;2025-12-12&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;1656346232784&#x27;</span>, <span class="string">&#x27;2022-06-28 12:10:32&#x27;</span>, <span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `t_trans_submit` <span class="keyword">VALUES</span> (<span class="number">1541453945194999809</span>, <span class="string">&#x27;8080808080&#x27;</span>, <span class="string">&#x27;1122334455667799&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;1122334455667788&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;100000&#x27;</span>, <span class="string">&#x27;转账用途&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;转账方式&#x27;</span>, <span class="string">&#x27;转账大写金额&#x27;</span>, <span class="string">&#x27;附言&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;备注&#x27;</span>, <span class="string">&#x27;预约处理&#x27;</span>, <span class="string">&#x27;预约时间&#x27;</span>, <span class="string">&#x27;2025-12-12&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;1656346234019&#x27;</span>, <span class="string">&#x27;2022-06-28 12:10:34&#x27;</span>, <span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `t_trans_submit` <span class="keyword">VALUES</span> (<span class="number">1541453950169444353</span>, <span class="string">&#x27;8080808080&#x27;</span>, <span class="string">&#x27;1122334455667799&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;1122334455667788&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;100000&#x27;</span>, <span class="string">&#x27;转账用途&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;转账方式&#x27;</span>, <span class="string">&#x27;转账大写金额&#x27;</span>, <span class="string">&#x27;附言&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;备注&#x27;</span>, <span class="string">&#x27;预约处理&#x27;</span>, <span class="string">&#x27;预约时间&#x27;</span>, <span class="string">&#x27;2025-12-12&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;1656346235206&#x27;</span>, <span class="string">&#x27;2022-06-28 12:10:35&#x27;</span>, <span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `t_trans_submit` <span class="keyword">VALUES</span> (<span class="number">1541611347942412289</span>, <span class="string">&#x27;8080808080&#x27;</span>, <span class="string">&#x27;1122334455667799&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;1122334455667788&#x27;</span>, <span class="string">&#x27;北京新天地科技股份有限公司&#x27;</span>, <span class="string">&#x27;1000&#x27;</span>, <span class="string">&#x27;100000&#x27;</span>, <span class="string">&#x27;转账用途&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;转账方式&#x27;</span>, <span class="string">&#x27;转账大写金额&#x27;</span>, <span class="string">&#x27;附言&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;备注&#x27;</span>, <span class="string">&#x27;预约处理&#x27;</span>, <span class="string">&#x27;预约时间&#x27;</span>, <span class="string">&#x27;2025-12-12&#x27;</span>, <span class="string">&#x27;13170030905&#x27;</span>, <span class="string">&#x27;1656383761745&#x27;</span>, <span class="string">&#x27;2022-06-28 02:36:01&#x27;</span>, <span class="keyword">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h1 id="《MySQL必知必会》读书笔记"><a href="#《MySQL必知必会》读书笔记" class="headerlink" title="《MySQL必知必会》读书笔记"></a>《MySQL必知必会》读书笔记</h1><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/alex_my/article/details/72357498">MySQL必知必会</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/alex_my/article/details/72626925">深入浅出MySQL</a></li>
</ul>
<h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><p><code>SHOW DATABASES;</code><br><code>SHOW TABLES;</code><br><code>SHOW COLUMNS FROM table;</code><br><code>SHOW STATUS;</code><br><code>SHOW CREATE DATABASE database;</code><br><code>SHOW CREATE TABLE table;</code></p>
<p><code>ALTER TABLE vendors ADD vend_phone CHAR(20) COMMENT &#39;手机&#39;;</code> – 新增列<br><code>ALTER TABLE vendors DROP COLUMN vend_phone;</code> – 删除列<br><code>DROP TABLE vendors</code> – 删除整个表<br><code>TRUNCATE TABLE...</code> – TRUNCATE TABLE语句，删除原来的表，并重新创建一个表。比DELETE删除所有行更快。<br><code>RENAME TABLE tab1 TO tab2;</code> – 重命名表<br><code>ALTER TABLE orderitems ADD CONSTRAINT fk_orderitems_orders FOREIGN KEY (order_num) REFERENCES orders(orderr_num);</code>– ALTER TABLE 定义外键</p>
<h2 id="DISTINCT和GROUP-BY"><a href="#DISTINCT和GROUP-BY" class="headerlink" title="DISTINCT和GROUP BY"></a>DISTINCT和GROUP BY</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT DISTINCT `role_id` FROM user;</span><br><span class="line">SELECT `role_id` FROM user GROUP BY `role_id`;</span><br></pre></td></tr></table></figure>

<p>二者都可以达到去重的效果。</p>
<p>DISTINCT把列中的全部内容存储到内存中，可以理解为一个hash，最后的到hash中的key就可以得到结果。比较耗内存。</p>
<p>GROUP BY先将列排序，然后去重。排序比较耗时间。</p>
<h2 id="LIMIT操作符"><a href="#LIMIT操作符" class="headerlink" title="LIMIT操作符"></a>LIMIT操作符</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT `role_id` FROM user LIMIT 5 OFFSET 3;</span><br><span class="line">SELECT `role_id` FROM user LIMIT 3, 5;</span><br></pre></td></tr></table></figure>

<h2 id="LIKE操作符"><a href="#LIKE操作符" class="headerlink" title="LIKE操作符"></a>LIKE操作符</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM user WHERE name LIKE &#x27;t%&#x27;;</span><br><span class="line">SELECT * FROM user WHERE name LIKE &#x27;%t%&#x27;;</span><br><span class="line">SELECT * FROM user WHERE name LIKE &#x27;a%e&#x27;;</span><br><span class="line">SELECT * FROM user WHERE name LIKE &#x27;t_&#x27;;    -- t1, t2</span><br><span class="line">SELECT * FROM user WHERE name LIKE &#x27;t__&#x27;;   -- t123, t34</span><br></pre></td></tr></table></figure>

<p>以上两句都是模糊匹配用户名以t开头。</p>
<p>%: 匹配任意0个或者多个字符。</p>
<p><code>_</code>:一个<code>_</code>匹配1个任意字符，且必须有一个。</p>
<h2 id="正则基本字符匹配"><a href="#正则基本字符匹配" class="headerlink" title="正则基本字符匹配"></a>正则基本字符匹配</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT name FROM user WHERE name REGEXP &#x27;t&#x27;;    -- t, t1, t2</span><br><span class="line">SELECT name FROM user WHERE name REGEXP &#x27;t.&#x27;;   -- t1, t2</span><br></pre></td></tr></table></figure>

<p><code>.</code>表示匹配任意一个字符。</p>
<p>LIKE和REGEXP区别:</p>
<p>LIKE 要求整个列匹配(使用通配符除外), REGEXP只要列中某个片段匹配即可。</p>
<p>假设有用户名为s123。则以下例子中, LIKE没有得到结果。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT name FROM user WHERE name LIKE &#x27;s1&#x27;;     -- 没有结果</span><br><span class="line">SELECT name FROM user WHERE name REGEXP &#x27;s1&#x27;;   -- s123</span><br></pre></td></tr></table></figure>

<h2 id="OR匹配"><a href="#OR匹配" class="headerlink" title="OR匹配"></a>OR匹配</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT name FROM user WHERE name REGEXP &#x27;s1|s2&#x27; ORDER BY name; -- s123, s2, s234</span><br></pre></td></tr></table></figure>

<p>使用|功能上类似于SELECT中的OR语句。多个OR语句可以使用正则表达式替代，更简洁。</p>
<h2 id="匹配几个字符之一"><a href="#匹配几个字符之一" class="headerlink" title="匹配几个字符之一"></a>匹配几个字符之一</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT name FROM user WHERE name REGEXP &#x27;s[1238]&#x27; ORDER BY name;  -- s123, s2, s234, s89</span><br></pre></td></tr></table></figure>

<p>相当于</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT name FROM user WHERE name REGEXP &#x27;s1|s2|s3|s8&#x27; ORDER BY name;</span><br></pre></td></tr></table></figure>

<p>也可以添加^，来匹配除指定以外的内容</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT name FROM user WHERE name REGEXP &#x27;s[^1238]&#x27; ORDER BY name;  -- s4, s5</span><br></pre></td></tr></table></figure>

<h2 id="匹配范围"><a href="#匹配范围" class="headerlink" title="匹配范围"></a>匹配范围</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT name FROM user WHERE name REGEXP &#x27;s[1-8]&#x27; ORDER BY name;  -- s123, s2, s89..</span><br><span class="line">SELECT name FROM user WHERE name REGEXP &#x27;[a-z][1-8]&#x27; ORDER BY name;  -- a1, b2, c3</span><br></pre></td></tr></table></figure>

<h2 id="匹配特殊字符"><a href="#匹配特殊字符" class="headerlink" title="匹配特殊字符"></a>匹配特殊字符</h2><p>为了匹配特殊字符，必须用\为前导。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT name FROM user WHERE name REGEXP &#x27;s\\-&#x27; ORDER BY name;  -- s-5</span><br></pre></td></tr></table></figure>

<p><code>\\</code>也用来引用具有特殊含义的字符</p>
<table>
<thead>
<tr>
<th>特殊字符</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>\f</td>
<td>换页</td>
</tr>
<tr>
<td>\n</td>
<td>换行</td>
</tr>
<tr>
<td>\r</td>
<td>回车</td>
</tr>
<tr>
<td>\t</td>
<td>制表</td>
</tr>
<tr>
<td>\v</td>
<td>纵向制表</td>
</tr>
</tbody></table>
<p>多数正则表达式使用<code>\</code>转义特殊字符，以便能使用这些字符本身。但MySQL要求用<code>\\</code>。</p>
<p>MySQL解释一个，正则表达式解释另外一个。</p>
<h2 id="匹配字符类"><a href="#匹配字符类" class="headerlink" title="匹配字符类"></a>匹配字符类</h2><p>为了方便工作，可以使用预定义的字符集</p>
<table>
<thead>
<tr>
<th><strong>类</strong></th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>[:alnum:]</td>
<td>任意字母和数字 ([a-zA-Z0-9])</td>
</tr>
<tr>
<td>[:alpha:]</td>
<td>任意字符 ([a-zA-Z])</td>
</tr>
<tr>
<td>[:blank:]</td>
<td>空格和指标 (\t)</td>
</tr>
<tr>
<td>[:cntrl:]</td>
<td>ASCII控制字符 (ASCII 0~31, 127)</td>
</tr>
<tr>
<td>[:digit:]</td>
<td>任意数字 ([0-9])</td>
</tr>
<tr>
<td>[:graph:]</td>
<td>与[:print:]相同，但不包括空格</td>
</tr>
<tr>
<td>[:lower:]</td>
<td>任意小写字母 ([a-z])</td>
</tr>
<tr>
<td>[:print:]</td>
<td>任意可打印的数字</td>
</tr>
<tr>
<td>[:punct:]</td>
<td>同时不在[:alnum:][:cntrl:]中的任意字符</td>
</tr>
<tr>
<td>[:space:]</td>
<td>包括空格在内的任意空白字符 ([\t\n\r\t\v])</td>
</tr>
<tr>
<td>[:upper:]</td>
<td>任意大写字母 ([A-Z])</td>
</tr>
<tr>
<td>[:xdigit:]</td>
<td>任意十六进制数字 ([a-fA-F0-9])</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT name FROM user WHERE name REGEXP &#x27;[[:alpha:]]1&#x27; ORDER BY name; -- h1, m1, s123</span><br></pre></td></tr></table></figure>

<h2 id="匹配多个实例"><a href="#匹配多个实例" class="headerlink" title="匹配多个实例"></a>匹配多个实例</h2><table>
<thead>
<tr>
<th>字符</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td>0个或多个匹配</td>
</tr>
<tr>
<td>+</td>
<td>1个或多个匹配 ({1, })</td>
</tr>
<tr>
<td>?</td>
<td>0个或1个匹配 ({0, 1})</td>
</tr>
<tr>
<td>{n}</td>
<td>指定数目的匹配</td>
</tr>
<tr>
<td>{n, }</td>
<td>不少于指定数目的匹配</td>
</tr>
<tr>
<td>{n, m}</td>
<td>匹配数目范围, m 不超过255</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT name FROM user WHERE name REGEXP &#x27;[[:digit:]]&#123;4&#125;&#x27; ORDER BY name; -- s4444, 21111</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT name FROM user WHERE name REGEXP &#x27;\\([0-9] sticks?\\)&#x27; ORDER BY name; -- 1 stick, 4 sticks  （s后的？使s可选）</span><br></pre></td></tr></table></figure>

<h2 id="定位符"><a href="#定位符" class="headerlink" title="定位符"></a>定位符</h2><table>
<thead>
<tr>
<th>元字符</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>^</td>
<td>文本的开始</td>
</tr>
<tr>
<td>$</td>
<td>文本的结尾</td>
</tr>
<tr>
<td>[[:&lt;:]]</td>
<td>词的开始</td>
</tr>
<tr>
<td>[[:&gt;:]]</td>
<td>词的结尾</td>
</tr>
</tbody></table>
<p>示例1：假设要找到以字母开头的用户名</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT  name FROM user WHERE name REGEXP &#x27;[a-zA-Z]&#x27;;</span><br></pre></td></tr></table></figure>

<p>以上语句将会在文本任意位置进行查找匹配，并不符合以字母开头这依规定. 这里可以使用<code>^</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT  name FROM user WHERE name REGEXP &#x27;^[a-zA-Z]&#x27;;</span><br></pre></td></tr></table></figure>

<p><code>^</code>的双重用途 ^有两种用法，在集合中（用 [ 和 ] 定义），用它来否定该集合，否则，用来指串的开始处。</p>
<h2 id="简单的正则表达式测试"><a href="#简单的正则表达式测试" class="headerlink" title="简单的正则表达式测试"></a>简单的正则表达式测试</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT &#x27;hello&#x27; REGEXP &#x27;[0-9]&#x27;; -- 返回0</span><br></pre></td></tr></table></figure>

<h2 id="拼接-CONCAT"><a href="#拼接-CONCAT" class="headerlink" title="拼接 CONCAT"></a>拼接 CONCAT</h2><p>表中含有id, name字段，应用程序需要这样的格式 name(id)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT CONCAT(name, &#x27;(&#x27;, id, &#x27;)&#x27;) FROM user LIMIT 1;   -- s123 (1000001)</span><br></pre></td></tr></table></figure>

<p>RTRIM()函数去掉了值右边的所有空格。其余有LTRIM(), TRIM()</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT CONCAT(RTRIM(name), &#x27;(&#x27;, id, &#x27;)&#x27;) FROM user LIMIT 1;   -- s123(1000001)</span><br></pre></td></tr></table></figure>

<h2 id="MySQL算术运算符-x2F"><a href="#MySQL算术运算符-x2F" class="headerlink" title="MySQL算术运算符(+ - * &#x2F;)"></a>MySQL算术运算符(+ - * &#x2F;)</h2><h2 id="测试计算"><a href="#测试计算" class="headerlink" title="测试计算"></a>测试计算</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT Trim(&#x27; abc &#x27;);</span><br><span class="line">SELECT Now();</span><br></pre></td></tr></table></figure>

<h2 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h2><table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
<th>示例</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td>CHAR_LENGTH(S)</td>
<td>返回字符串s字符数</td>
<td>SELECT CHAR_LENGTH(‘abc 你好’);</td>
<td>6</td>
</tr>
<tr>
<td>LENGTH(S)</td>
<td>返回字符串s的长度</td>
<td>SELECT LENGTH(‘abc 你好’);</td>
<td>10</td>
</tr>
<tr>
<td>CONCAT(S1,S2,…)</td>
<td>合并为一个字符串</td>
<td>SELECT CONCAT(‘hello’, ’ abc’);</td>
<td>hello abc</td>
</tr>
<tr>
<td>CONCAT_WS(x, s1, s2,…)</td>
<td>同CONCAT,但会加上x</td>
<td>SELECT CONCAT_WS(’+’, ‘1’, ‘2’, ‘3’);</td>
<td>1+2+3</td>
</tr>
<tr>
<td>INSERT(s1, x, length, s2)</td>
<td>将字符串s2替换s1的x位置开始长度为length的字符串</td>
<td>SELECT INSERT(‘abcdefg’, 2, 3, ‘123’);</td>
<td>a123efg</td>
</tr>
<tr>
<td>UPPER(s)</td>
<td>将字符串s的所有字母变成大写字母</td>
<td>SELECT UPPER(‘abcd’);</td>
<td>ABCD</td>
</tr>
<tr>
<td>LOWER(s)</td>
<td>将字符串s的所有字母变成小写字母</td>
<td>SELECT LOWER(‘ABCD’);</td>
<td>abcd</td>
</tr>
<tr>
<td>LEFT(s, n)</td>
<td>返回字符串s的前n个字符</td>
<td>SELECT LEFT(‘abcdef’, 3);</td>
<td>abc</td>
</tr>
<tr>
<td>RIGHT(s, n)</td>
<td>返回字符串s的后n个字符</td>
<td>SELECT RIGHT(‘abcdef’, 3);</td>
<td>def</td>
</tr>
<tr>
<td>LPAD(s1, length, s2)</td>
<td>字符串s2来填充s1的开始处，使字符串长度达到length</td>
<td>SELECT LPAD(‘abc’, 8, ‘123’);</td>
<td>12312abc</td>
</tr>
<tr>
<td>RPAD(s1, length, s2)</td>
<td>字符串s2来填充s1的结尾处，使字符串的长度达到length</td>
<td>SELECT RPAD(‘abc’, 8, ‘123’);</td>
<td>abc12312</td>
</tr>
<tr>
<td>LTRIM(s)</td>
<td>去掉字符串s开始处的空格</td>
<td>SELECT LTRIM(’ abc ‘);</td>
<td>‘abc ’</td>
</tr>
<tr>
<td>RTRIM(s)</td>
<td>去掉字符串s结尾处的空格</td>
<td>SELECT RTRIM(’ abc ‘);</td>
<td>’ abc’</td>
</tr>
<tr>
<td>TRIM(s)</td>
<td>去掉字符串s开始和结尾处的空格</td>
<td>SELECT TRIM(’ abc ‘);</td>
<td>‘abc’</td>
</tr>
<tr>
<td>TRIM(s1 FROM s)</td>
<td>去掉字符串s中开始处和结尾处的字符串s1</td>
<td>SELECT TRIM(’-’ FROM ‘—hello–’);</td>
<td>hello</td>
</tr>
<tr>
<td>REPEAT(s, n)</td>
<td>将字符串s重复n次</td>
<td>SELECT REPEAT(‘abc’, 3);</td>
<td>abcabcabc</td>
</tr>
<tr>
<td>SPACE(n)</td>
<td>返回n个空格</td>
<td>SELECT SPACE(3);</td>
<td>’  ’</td>
</tr>
<tr>
<td>REPLACE(s, s1, s2)</td>
<td>将字符串s2替代字符串s中的字符串s1</td>
<td>SELECT REPLACE(‘abcdef’, ‘abc’, ‘12’);</td>
<td>12def</td>
</tr>
<tr>
<td>STRCMP(s1, s2)</td>
<td>比较字符串s1和s2</td>
<td>SELECT STRCMP(‘abc’, ‘abc’);</td>
<td>0</td>
</tr>
<tr>
<td>STRCMP(s1, s2)</td>
<td>比较字符串s1和s2</td>
<td>SELECT STRCMP(‘abc’, ‘abcd’);</td>
<td>-1</td>
</tr>
<tr>
<td>STRCMP(s1, s2)</td>
<td>比较字符串s1和s2</td>
<td>SELECT STRCMP(‘abc’, ‘ab’);</td>
<td>1</td>
</tr>
<tr>
<td>SUBSTRING(s, n, length)</td>
<td>获取从字符串s中的第n个位置开始长度为length的字符串</td>
<td>SELECT SUBSTRING(‘abcdefg’, 2, 3);</td>
<td>bcd</td>
</tr>
<tr>
<td>MID(s, n, length)</td>
<td>同SUBSTRING</td>
<td>SELECT MID(‘abcdefg’, 3, 2);</td>
<td>cd</td>
</tr>
<tr>
<td>LOCATE(s1, s)</td>
<td>从字符串s中获取s1的开始位置</td>
<td>SELECT LOCATE(‘de’, ‘abcdefg’);</td>
<td>4</td>
</tr>
<tr>
<td>POSITION(s1, s)</td>
<td>从字符串s中获取s1的开始位置</td>
<td>SELECT POSITION(‘de’ IN ‘abcdefg’);</td>
<td>4</td>
</tr>
<tr>
<td>INSTR(s, s1)</td>
<td>从字符串s中获取s1的开始位置</td>
<td>SELECT INSTR(‘abcdefg’, ‘de’);</td>
<td>4</td>
</tr>
<tr>
<td>REVERSE(s)</td>
<td>将字符串s的顺序反过来</td>
<td>SELECT REVERSE(‘a,b,c,d,e,f’);</td>
<td>f,e,d,c,b,a</td>
</tr>
<tr>
<td>ELT(n, s1, s2, …)</td>
<td>返回第n个字符串</td>
<td>SELECT ELT(3, ‘abc’, ‘def’, ‘ghi’, ‘jkl’);</td>
<td>ghi</td>
</tr>
<tr>
<td>EXPORT_SET(…)</td>
<td>见示例</td>
<td>SELECT EXPORT_SET(6, ‘y’, ‘n’, ‘_’, 3);</td>
<td>n_y_y</td>
</tr>
<tr>
<td>FIELD(s, s1, s2, …)</td>
<td>返回第一个与字符串s匹配的字符串位置</td>
<td>SELECT FIELD(‘b’, ‘a’, ‘b’, ‘c’);</td>
<td>2</td>
</tr>
<tr>
<td>FIND_IN_SET(str, str_list)</td>
<td>见示例</td>
<td>SELECT FIND_IN_SET(‘4’, ‘6,5,4,3,2,1’);</td>
<td>3</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>SOUNDEX()</td>
<td>是一个将任何文本串转换为描述其语音表示的字母数字模式的算法</td>
<td>Y Lee 和 Y Lie 发音相似</td>
<td></td>
</tr>
</tbody></table>
<h2 id="日期时间函数"><a href="#日期时间函数" class="headerlink" title="日期时间函数"></a>日期时间函数</h2><table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
<th>示例</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td>CURDATE(), CURRENT_DATE()</td>
<td>返回当前日期</td>
<td>SELECT CURRENT_DATE();</td>
<td>2017-05-11</td>
</tr>
<tr>
<td>CURTIME(), CURRENT_TIME</td>
<td>返回当前时间</td>
<td>SELECT CURRENT_TIME();</td>
<td>19:01:11</td>
</tr>
<tr>
<td>NOW()</td>
<td>返回当前日期和时间</td>
<td>SELECT NOW();</td>
<td>2017-05-11 19:01:30</td>
</tr>
<tr>
<td>CURRENT_TIMESTAMP()</td>
<td>返回当前日期和时间</td>
<td>同上</td>
<td></td>
</tr>
<tr>
<td>LOCALTIME()</td>
<td>返回当前日期和时间</td>
<td>同上</td>
<td></td>
</tr>
<tr>
<td>SYSDATE()</td>
<td>返回当前日期和时间</td>
<td>同上</td>
<td></td>
</tr>
<tr>
<td>LOCALTIMESTAMP()</td>
<td>返回当前日期和时间</td>
<td>同上</td>
<td></td>
</tr>
<tr>
<td>UNIX_TIMESTAMP()</td>
<td>以UNIX时间戳的形式返回当前时间</td>
<td>SELECT UNIX_TIMESTAMP();</td>
<td>1494500521</td>
</tr>
<tr>
<td>UNIX_TIMESTAMP(d)</td>
<td>将时间d以UNIX时间戳的形式返回</td>
<td>SELECT UNIX_TIMESTAMP(‘2017-05-11 19:02:01’);</td>
<td>1494500521</td>
</tr>
<tr>
<td>FROM_UNIXTIME(d)</td>
<td>将UNIX时间戳的时间转换为普通格式的时间</td>
<td>SELECT FROM_UNIXTIME(1494500521);</td>
<td>2017-05-11 19:02:01</td>
</tr>
<tr>
<td>UTC_DATE()</td>
<td>返回UTC日期</td>
<td>SELECT UTC_DATE();</td>
<td>2017-05-11</td>
</tr>
<tr>
<td>UTC_TIME()</td>
<td>返回UTC时间</td>
<td>SELECT UTC_TIME();</td>
<td>11:06:13</td>
</tr>
<tr>
<td>MONTH(d)</td>
<td>返回日期d中的月份值，1-&gt;12</td>
<td>SELECT MONTH(‘2017-05-11’);</td>
<td>5</td>
</tr>
<tr>
<td>MONTHNAME(d)</td>
<td>返回日期当中的月份名称</td>
<td>SELECT MONTHNAME(‘2017-05-11’);</td>
<td>May</td>
</tr>
<tr>
<td>DAYNAME(d)</td>
<td>返回日期d是星期几</td>
<td>SELECT DAYNAME(‘2017-05-11 19:07:12’);</td>
<td>Thursday</td>
</tr>
<tr>
<td>DAYOFWEEK(d)</td>
<td>日期d今天是星期几，1星期日，2星期一</td>
<td>SELECT DAYOFWEEK(‘2017-05-11’);</td>
<td>5</td>
</tr>
<tr>
<td>WEEKDAY(d)</td>
<td>日期d今天是星期几，0表示星期一，1表示星期二</td>
<td>SELECT WEEKDAY(‘2017-05-11’);</td>
<td>3</td>
</tr>
<tr>
<td>WEEK(d)，WEEKOFYEAR(d)</td>
<td>计算日期d是本年的第几个星期，范围是0-&gt;53</td>
<td>SELECT WEEK(‘2017-05-11’);</td>
<td>19</td>
</tr>
<tr>
<td>DAYOFYEAR(d)</td>
<td>计算日期d是本年的第几天</td>
<td>SELECT DAYOFYEAR(‘2017-05-11’);</td>
<td>131</td>
</tr>
<tr>
<td>DAYOFMONTH(d)</td>
<td>计算日期d是本月的第几天</td>
<td>SELECT DAYOFMONTH(‘2017-05-11’);</td>
<td>11</td>
</tr>
<tr>
<td>QUARTER(d)</td>
<td>返回日期d是第几季节，返回1-&gt;4</td>
<td>SELECT QUARTER(‘2017-05-11’);</td>
<td>2</td>
</tr>
<tr>
<td>HOUR(t)</td>
<td>返回t中的小时值</td>
<td>SELECT HOUR(‘2017-05-11 19:11:23’);</td>
<td>19</td>
</tr>
<tr>
<td>MINUTE(t)</td>
<td>返回t中的分钟值</td>
<td>SELECT MINUTE(‘2017-05-11 19:11:23’);</td>
<td>11</td>
</tr>
<tr>
<td>SECOND(t)</td>
<td>返回t中的秒钟值</td>
<td>SELECT SECOND(‘2017-05-11 19:11:23’);</td>
<td>23</td>
</tr>
<tr>
<td>EXTRACT(type FROM d)</td>
<td>从日期d中获取指定的值，type指定返回的值(见下文)</td>
<td>SELECT EXTRACT(WEEK FROM ‘2017-05-11 19:11:23’);</td>
<td>19</td>
</tr>
<tr>
<td>TIME_TO_SEC(t)</td>
<td>将时间t转换为秒</td>
<td>SELECT TIME_TO_SEC(‘19:11:23’);</td>
<td>69083</td>
</tr>
<tr>
<td>SEC_TO_TIME(s)</td>
<td>将以秒为单位的时间s转换为时分秒的格式</td>
<td>SELECT SEC_TO_TIME(69083);</td>
<td>19:11:23</td>
</tr>
<tr>
<td>TO_DAYS(d)</td>
<td>计算日期d距离0000年1月1日的天数</td>
<td>SELECT TO_DAYS(‘2017-05-11 19:11:23’);</td>
<td>736825</td>
</tr>
<tr>
<td>FROM_DAYS(n)</td>
<td>计算从0000年1月1日开始n天后的日期</td>
<td>SELECT FROM_DAYS(736825);</td>
<td>2017-05-11</td>
</tr>
<tr>
<td>DATEDIFF(d1,d2)</td>
<td>计算日期d1-&gt;d2之间相隔的天数</td>
<td>SELECT DATEDIFF(‘2017-05-11’, ‘2017-05-12’);</td>
<td>-1</td>
</tr>
<tr>
<td>ADDDATE(d,n)</td>
<td>计算其实日期d加上n天的日期</td>
<td>SELECT ADDDATE(‘2017-05-11 19:11:23’, 3);</td>
<td>2017-05-14 19:11:23</td>
</tr>
<tr>
<td>ADDDATE(d，INTERVAL expr type)</td>
<td>计算起始日期d加上一个时间段后的日期</td>
<td>SELECT ADDDATE(‘2017-05-11 19:11:23’, INTERVAL 3 HOUR);</td>
<td>2017-05-11 22:11:23</td>
</tr>
<tr>
<td>DATE_ADD(d,INTERVAL expr type)</td>
<td>同上</td>
<td>SELECT DATE_ADD(‘2017-05-11 19:11:23’, INTERVAL 10 HOUR);</td>
<td>2017-05-12 05:11:23</td>
</tr>
<tr>
<td>SUBDATE(d,n)</td>
<td>日期d减去n天后的日期</td>
<td>SELECT SUBDATE(‘2017-05-12 05:11:23’, 13);</td>
<td>2017-04-29 05:11:23</td>
</tr>
<tr>
<td>SUBDATE(d,INTERVAL expr type)</td>
<td>日期d减去一个时间段后的日期</td>
<td>SELECT SUBDATE(‘2017-04-29 05:11:23’, INTERVAL 10 MINUTE);</td>
<td>2017-04-29 05:01:23</td>
</tr>
<tr>
<td>ADDTIME(t,n)</td>
<td>时间t加上n秒的时间</td>
<td>SELECT ADDTIME(‘2017-04-29 05:01:23’, 30);</td>
<td>2017-04-29 05:01:53</td>
</tr>
<tr>
<td>SUBTIME(t,n)</td>
<td>时间t减去n秒的时间</td>
<td>SELECT SUBTIME(‘2017-04-29 05:01:53’, 30);</td>
<td>2017-04-29 05:01:23</td>
</tr>
<tr>
<td>DATE_FORMAT(d,f)</td>
<td>按表达式f的要求显示日期d</td>
<td>SELECT DATE_FORMAT(‘2017-04-29 05:01:23’, ‘%Y-%m-%d’);</td>
<td>2017-04-29</td>
</tr>
<tr>
<td>TIME_FORMAT(t,f)</td>
<td>按表达式f的要求显示时间t</td>
<td>SELECT TIME_FORMAT(‘2017-04-29 05:01:23’, ‘%r’);</td>
<td>05:01:23 AM</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">DATE_ADD(<span class="type">date</span>,<span class="type">INTERVAL</span> expr type) 函数向日期添加指定的时间间隔。</span><br><span class="line">DATE_SUB(<span class="type">date</span>,<span class="type">INTERVAL</span> expr type) 函数向日期减少指定的时间间隔。</span><br></pre></td></tr></table></figure>

<p>type的值可以为:</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">MICROSECOND</span><br><span class="line"><span class="keyword">SECOND</span></span><br><span class="line"><span class="keyword">MINUTE</span></span><br><span class="line"><span class="keyword">HOUR</span></span><br><span class="line"><span class="keyword">DAY</span></span><br><span class="line">WEEK</span><br><span class="line"><span class="keyword">MONTH</span></span><br><span class="line">QUARTER</span><br><span class="line"><span class="keyword">YEAR</span></span><br><span class="line">SECOND_MICROSECOND</span><br><span class="line">MINUTE_MICROSECOND</span><br><span class="line">MINUTE_SECOND</span><br><span class="line">HOUR_MICROSECOND</span><br><span class="line">HOUR_SECOND</span><br><span class="line">HOUR_MINUTE</span><br><span class="line">DAY_MICROSECOND</span><br><span class="line">DAY_SECOND</span><br><span class="line">DAY_MINUTE</span><br><span class="line">DAY_HOUR</span><br><span class="line">YEAR_MONTH</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@dt</span> <span class="operator">=</span> now();</span><br><span class="line"><span class="keyword">select</span> date_add(<span class="variable">@dt</span>, <span class="type">interval</span> <span class="number">1</span> <span class="keyword">day</span>); <span class="operator">-</span> 加<span class="number">1</span>天</span><br><span class="line"><span class="keyword">UPDATE</span> comment c <span class="keyword">set</span> c.time <span class="operator">=</span> DATE_ADD(c.time, <span class="type">INTERVAL</span> <span class="number">7</span> <span class="keyword">DAY</span>) ;</span><br><span class="line"><span class="keyword">UPDATE</span> comment c <span class="keyword">set</span> c.time <span class="operator">=</span> DATE_SUB(c.time, <span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">MONTH</span>)</span><br></pre></td></tr></table></figure>

<p>案例实践：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM orders WHERE Date(order_date)=&#x27;2022-02-26&#x27;;</span><br><span class="line">SELECT * FROM orders WHERE Year(order_date)=2022 AND Month(order_date)=9</span><br></pre></td></tr></table></figure>

<h2 id="数值处理函数"><a href="#数值处理函数" class="headerlink" title="数值处理函数"></a>数值处理函数</h2><table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
<th>示例</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td>ABS(x)</td>
<td>返回x的绝对值</td>
<td></td>
<td></td>
</tr>
<tr>
<td>CEIL(x)</td>
<td>返回大于或等于x的最小整数</td>
<td></td>
<td></td>
</tr>
<tr>
<td>CEILING(x)</td>
<td>返回大于或等于x的最小整数</td>
<td></td>
<td></td>
</tr>
<tr>
<td>FLOOR(x)</td>
<td>返回小于或等于x的最大整数</td>
<td></td>
<td></td>
</tr>
<tr>
<td>RAND()</td>
<td>返回0-&gt;1的随机数</td>
<td></td>
<td></td>
</tr>
<tr>
<td>RAND(x)</td>
<td>返回0-&gt;1的随机数，x值相同时返回的随机数相同</td>
<td></td>
<td></td>
</tr>
<tr>
<td>SIGN(x)</td>
<td>返回x的符号，x是负数、0、正数分别返回-1、0和1</td>
<td></td>
<td></td>
</tr>
<tr>
<td>PI()</td>
<td>返回圆周率(3.141593）</td>
<td></td>
<td></td>
</tr>
<tr>
<td>TRUNCATE(x, y)</td>
<td>返回数值x保留到小数点后y位的值(不会四舍五入)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ROUND(x)</td>
<td>返回离x最近的整数</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ROUND(x, y)</td>
<td>保留x小数点后y位的值(四舍五入)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>POW(x, y)</td>
<td>返回x的y次方</td>
<td></td>
<td></td>
</tr>
<tr>
<td>POWER(x, y)</td>
<td>返回x的y次方</td>
<td></td>
<td></td>
</tr>
<tr>
<td>SQRT(x)</td>
<td>返回x的平方根</td>
<td></td>
<td></td>
</tr>
<tr>
<td>EXP(x)</td>
<td>返回e的x次方</td>
<td></td>
<td></td>
</tr>
<tr>
<td>MOD(x, y)</td>
<td>返回x除以y以后的余数</td>
<td></td>
<td></td>
</tr>
<tr>
<td>LOG(x)</td>
<td>返回自然对数(以e为底的对数)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>LOG10(x)</td>
<td>返回以10为底的对数</td>
<td></td>
<td></td>
</tr>
<tr>
<td>RADIANS(x)</td>
<td>将角度转换为弧度</td>
<td></td>
<td></td>
</tr>
<tr>
<td>DEGREES(x)</td>
<td>将弧度转换为角度</td>
<td></td>
<td></td>
</tr>
<tr>
<td>SIN(x)</td>
<td>求正弦值(参数是弧度)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ASIN(x)</td>
<td>求反正弦值(参数是弧度)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>COS(x)</td>
<td>求余弦值(参数是弧度)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ACOS(x)</td>
<td>求反余弦值(参数是弧度)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>TAN(x)</td>
<td>求正切值(参数是弧度)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ATAN(), ATAN2()</td>
<td>求反正切值(参数是弧度)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>COT()</td>
<td>求余切值(参数是弧度)</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="条件判断函数"><a href="#条件判断函数" class="headerlink" title="条件判断函数"></a>条件判断函数</h2><p>IF (expr, v1, v2);</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT IF (1 &gt; 0, &#x27;Y&#x27;, &#x27;N&#x27;);	-- Y</span><br></pre></td></tr></table></figure>

<p>IFNULL(v1, v2);</p>
<p>如果v1不为NULL, 返回v1，否则返回v2</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT IFNULL(&#x27;a&#x27;, &#x27;b&#x27;);	-- a</span><br></pre></td></tr></table></figure>

<h2 id="系统信息函数"><a href="#系统信息函数" class="headerlink" title="系统信息函数"></a>系统信息函数</h2><table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
<th>示例</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td>VERSION()</td>
<td>返回数据库的版本号</td>
<td>SELECT VERSION();</td>
<td>5.7.11</td>
</tr>
<tr>
<td>CONNECTION_ID()</td>
<td>返回服务器的连接数</td>
<td>SELECT CONNECTION_ID();</td>
<td>13</td>
</tr>
<tr>
<td>DATABASE()</td>
<td>返回当前数据库名</td>
<td>SELECT DATABASE();</td>
<td>database-learn</td>
</tr>
<tr>
<td>USER()</td>
<td>返回当前用户</td>
<td>SELECT USER();</td>
<td>root@localhost</td>
</tr>
<tr>
<td>CHARSET(s)</td>
<td>返回字符串s的字符集</td>
<td>SELECT CHARSET(“123”);</td>
<td>utf8</td>
</tr>
<tr>
<td>COLLATION(s)</td>
<td>返回字符串s的字符排列方式</td>
<td>SELECT COLLATION(“a123”);</td>
<td>utf8_general_ci</td>
</tr>
<tr>
<td>LAST_INSERT_ID()</td>
<td>返回最近生成的AUTO_INCREMENT值</td>
<td>SELECT LAST_INSERT_ID();</td>
<td>0</td>
</tr>
</tbody></table>
<h2 id="聚集函数"><a href="#聚集函数" class="headerlink" title="聚集函数"></a>聚集函数</h2><table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>AVG()</td>
<td>返回某列的平均值</td>
</tr>
<tr>
<td>COUNT()</td>
<td>返回某列的行数</td>
</tr>
<tr>
<td>MAX()</td>
<td>返回某列的最大值</td>
</tr>
<tr>
<td>MIN()</td>
<td>返回某列的最小值</td>
</tr>
<tr>
<td>SUM()</td>
<td>返回某列值之和</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT SUM(price*quantity) AS total_price FROM orderitems;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT AVG(DISTINCT prod_price) AS avg_price FROM products;</span><br></pre></td></tr></table></figure>

<h2 id="数据分组"><a href="#数据分组" class="headerlink" title="数据分组"></a>数据分组</h2><p>假设要获取用户的充值次数，最低充值额度，最高充值额度，平均充值额度，可以用以下命令:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT role_id, </span><br><span class="line">COUNT(*) AS num, </span><br><span class="line">MIN(money) as min_money, </span><br><span class="line">MAX(money) as max_money, </span><br><span class="line">AVG(money) AS avg_money </span><br><span class="line">FROM user_pay;</span><br></pre></td></tr></table></figure>

<p>以上得出的是总的信息，如果要获取每个用户的这些信息，就可以使用分组了。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT </span><br><span class="line">role_id, </span><br><span class="line">COUNT(*) AS num, </span><br><span class="line">MIN(money) as min_money, </span><br><span class="line">MAX(money) as max_money, </span><br><span class="line">AVG(money) AS avg_money </span><br><span class="line">FROM user_pay </span><br><span class="line">GROUP BY role_id </span><br><span class="line">ORDER BY num;</span><br></pre></td></tr></table></figure>

<p>需要注意的是，GROUP BY 必须出现在 WHERE 之后，ORDER BY 之前</p>
<p>可以使用WITH ROLLUP得到汇总的值</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT </span><br><span class="line">role_id, </span><br><span class="line">COUNT(*) AS num, </span><br><span class="line">MIN(money) as min_money, </span><br><span class="line">MAX(money) as max_money, </span><br><span class="line">AVG(money) AS avg_money </span><br><span class="line">FROM user_pay </span><br><span class="line">GROUP BY role_id </span><br><span class="line">WITH ROLLUP;</span><br></pre></td></tr></table></figure>

<p>以上在在结果的最后，会附上总的结果。</p>
<h2 id="分组过滤HAVING"><a href="#分组过滤HAVING" class="headerlink" title="分组过滤HAVING"></a>分组过滤HAVING</h2><p>假设只需要得到充值2次(包含)以上用户的数据，则需要使用HAVING来过滤。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT role_id, </span><br><span class="line">COUNT(*) AS num, </span><br><span class="line">FROM user_pay </span><br><span class="line">GROUP BY role_id </span><br><span class="line">HAVING num &gt;= 2 </span><br><span class="line">ORDER BY num;</span><br></pre></td></tr></table></figure>

<p>注意HAVING跟GROUP BY后面。</p>
<p>也可以同时使用WHERE和HAVING。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT role_id, </span><br><span class="line">COUNT(*) AS num, </span><br><span class="line">MIN(money) as min_money, </span><br><span class="line">MAX(money) as max_money, </span><br><span class="line">AVG(money) AS avg_money </span><br><span class="line">FROM user_pay </span><br><span class="line">WHERE time &gt;= 1483200000 </span><br><span class="line">GROUP BY role_id </span><br><span class="line">HAVING num &gt;= 2 </span><br><span class="line">ORDER BY num;</span><br></pre></td></tr></table></figure>

<p>以上通过WHERE新增了条件，2017年以来充值的。</p>
<p>当sql_mode为ONLY_FULL_GROUP_BY需要注意</p>
<p>查看sql_mode值</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT @@sql_mode;</span><br></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION</span><br></pre></td></tr></table></figure>

<p>在sql_mode&#x3D;ONLY_FULL_GROUP_BY的模式下，以下句子报错</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT role_id, money FROM user_pay GROUP BY role_id;</span><br></pre></td></tr></table></figure>

<p>错误: <code>SELECT list is not in GROUP BY clause and contains nonaggregated column ...</code><br>**<code>表中的列</code>**，出现在SELECT中时，也得出现在GROUP BY中。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT role_id, money FROM user_pay GROUP BY role_id, money;</span><br></pre></td></tr></table></figure>

<h2 id="SELECT字句顺序"><a href="#SELECT字句顺序" class="headerlink" title="SELECT字句顺序"></a>SELECT字句顺序</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT &gt; FROM &gt; WHERE &gt; GROUP BY &gt; HAVING &gt; ORDER BY &gt; LIMIT</span><br></pre></td></tr></table></figure>

<h2 id="做为计算字段使用子查询"><a href="#做为计算字段使用子查询" class="headerlink" title="做为计算字段使用子查询"></a>做为计算字段使用子查询</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT  </span><br><span class="line">role_id,</span><br><span class="line">name,</span><br><span class="line">(SELECT COUNT(*)</span><br><span class="line">FROM user_pay</span><br><span class="line">WHERE user_pay.role_id = user.role_id) AS recharge_count</span><br><span class="line">FROM user</span><br><span class="line">LIMIT 10;</span><br></pre></td></tr></table></figure>

<p>ANSI SQL规范首选INNER JOIN。代替没有关键字的联结</p>
<p>INSERT 和 INTO 之间添加关键字LOW_PRIORITY,降低优先级</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">INSERT LOW_PRIORITY ITNO </span><br></pre></td></tr></table></figure>

<p>单条INSERT语句处理多个插入比使用多条INSERT语句快</p>
<p>IGNORE关键字，即使发生错误，也继续进行更新</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UPDATE IGNORE customers...</span><br></pre></td></tr></table></figure>

<p>SELECT last_insert_id() 返回最后一个自增id</p>
<p>MySQL 不允许使用函数作为默认值</p>
<p>使用默认值而不是null值，特别是对用于计算或数据分组的列更是如此</p>
<p>InnoDB是一个可靠的事务处理引擎，它不支持全文本搜索</p>
<p>MEMORY在功能等同于MyISAM，但由于数据存储在内存中，速度很快（特别适合临时表）</p>
<p>MyISAM是一个性能极高的引擎，它支持全文本搜索，但不支持事务处理。</p>
<p><a target="_blank" rel="noopener" href="http://dev.mysql.com/doc/refman/5.0/en/storage_engines.html">http://dev.mysql.com/doc/refman/5.0/en/storage_engines.html</a></p>
<h2 id="创建视图"><a href="#创建视图" class="headerlink" title="创建视图"></a>创建视图</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE OR REPLACE VIEW user_pay_info AS</span><br><span class="line">SELECT b.role_id, </span><br><span class="line">b.name, </span><br><span class="line">SUM(a.money) AS total_money</span><br><span class="line">FROM user_pay a</span><br><span class="line">RIGHT JOIN user b</span><br><span class="line">ON a.role_id = b.role_id</span><br><span class="line">GROUP BY b.role_id;</span><br></pre></td></tr></table></figure>

<p>创建一个视图，该视图从用户表(user), 用户充值表(user_pay)获取用户基本信息，总充值额度。</p>
<h2 id="创建存储过程CREATE-PROCEDURE"><a href="#创建存储过程CREATE-PROCEDURE" class="headerlink" title="创建存储过程CREATE PROCEDURE"></a>创建存储过程CREATE PROCEDURE</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE PROCEDURE user_pay_total()</span><br><span class="line">BEGIN</span><br><span class="line">SELECT role_id, SUM(money) AS total_recharge</span><br><span class="line">FROM user_pay</span><br><span class="line">GROUP BY role_id;</span><br><span class="line">END</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DELIMITER //</span><br><span class="line">CREATE PROCEDURE user_pay_total()</span><br><span class="line">BEGIN</span><br><span class="line">SELECT role_id, SUM(money) AS total_recharge</span><br><span class="line">FROM user_pay</span><br><span class="line">GROUP BY role_id;</span><br><span class="line">END //</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<p>以上DELIMITER告诉命令行工具，使用<code>//</code>做为分隔符。最后一句恢复回<code>;</code>做为分隔符。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CALL user_pay_total(); -- 使用存储过程 CALL</span><br><span class="line">DROP PROCEDURE user_pay_total; -- 删除存储过程 DROP</span><br><span class="line">DROP PROCEDURE IF EXISTS user_pay_total;-- 删除（建议使用）</span><br></pre></td></tr></table></figure>

<h2 id="存储过程使用参数"><a href="#存储过程使用参数" class="headerlink" title="存储过程使用参数"></a>存储过程使用参数</h2><p>参数可以用IN, OUT, INOUT修饰。</p>
<p><font color="#f0f"><b>例1：</b></font></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE PROCEDURE productpricing(</span><br><span class="line">    OUT p1 DECIMAL(8,2),</span><br><span class="line">    OUT ph DECIMAL(8,2),</span><br><span class="line">    OUT pa DECIMAL(8,2)</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">	SELECT Min(prod_price)</span><br><span class="line">	INTO p1</span><br><span class="line">	FROM products;</span><br><span class="line">	SELECT Max(prod_price)</span><br><span class="line">	INTO ph</span><br><span class="line">	FROM products;</span><br><span class="line">	SELECT AVG(prod_price)</span><br><span class="line">	INTO pa</span><br><span class="line">	FROM products;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<p>使用：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CALL productpricing(@pricelow,</span><br><span class="line">                    @pricehigh,</span><br><span class="line">                    @priceaverage);</span><br><span class="line">SELECT @priceaverage;</span><br><span class="line">SELECT @pricelow, @pricehigh, @priceaverage;</span><br></pre></td></tr></table></figure>

<p><font color="#f0f"><b>例2：</b></font></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE PROCEDURE ordertotal(</span><br><span class="line">    IN onumber INT,</span><br><span class="line">    OUT ototal DECIMAL(8,2)</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">	SELECT Sum(item_price*quantity)</span><br><span class="line">	FROM orderitems</span><br><span class="line">	WHERE order_num = onmber</span><br><span class="line">	INTO ototal;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CALL ordertotal(2005,@total);</span><br><span class="line">SELECT @total</span><br></pre></td></tr></table></figure>

<h2 id="建立智能存储过程案例"><a href="#建立智能存储过程案例" class="headerlink" title="建立智能存储过程案例"></a>建立智能存储过程案例</h2><p>你现在需要获得与以前一样的订单合计，但是，需要对合计增加营业税，不过，只是针对某些顾客(或许是你所在的城市的那些顾客)。那么，你需要做<br>1）获得合计(与以前一样)；<br>2）把营业税有条件的添加到合计中；<br>3）返回合计(带或不带税)；</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-- Name：ordertotal</span><br><span class="line">-- Parameters： onumber = order number</span><br><span class="line">--              taxable = 0 if not taxable,1 if taxable</span><br><span class="line">--              ototal = order total variable</span><br><span class="line"></span><br><span class="line">CREATE PROCEDURE ordertotal(</span><br><span class="line">    IN onumber INT,</span><br><span class="line">    IN taxable BOOLEAN,</span><br><span class="line">    OUT ototal DECIMAL(8,2)</span><br><span class="line">)COMMENT &#x27;Obtain order total, optionally adding tax&#x27;</span><br><span class="line">BEGIN</span><br><span class="line">    -- declear variable for total</span><br><span class="line">    DECLARE total DECIMAL(8,2);</span><br><span class="line">    -- declear tax percentage</span><br><span class="line">    DECLARE taxrate INT DEFAULT 6;</span><br><span class="line">    -- get the order total</span><br><span class="line">    SELECT Sum(item_price * quantity) FROM orderitems WHERE order_num = onumber INTO total;</span><br><span class="line"></span><br><span class="line">    -- IS this taxable?</span><br><span class="line">    IF taxable THEN </span><br><span class="line">       -- yes ,so add taxrate to the total</span><br><span class="line">       SELECT total+(total/100*taxrate)INTO total;</span><br><span class="line">    END IF;</span><br><span class="line"> 	-- And finally ,save to out variable</span><br><span class="line"> 	SELECT total INTO ototal;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<p>使用：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CALL ordertotal（20005, 0, @total);</span><br><span class="line">SELECT @total;</span><br><span class="line"></span><br><span class="line">CALL ordertotal（20006, 1, @total);</span><br><span class="line">SELECT @total;</span><br></pre></td></tr></table></figure>

<h2 id="检测存储过程"><a href="#检测存储过程" class="headerlink" title="检测存储过程"></a>检测存储过程</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SHOW CREATE PROCEDURE user_pay_info;</span><br><span class="line"></span><br><span class="line">SHOW PROCEDURE STATUS LIKE &#x27;ordertotal&#x27;;</span><br></pre></td></tr></table></figure>

<h1 id="《高性能MySQL》读书笔记"><a href="#《高性能MySQL》读书笔记" class="headerlink" title="《高性能MySQL》读书笔记"></a>《高性能MySQL》读书笔记</h1><p><img src="/../../assets/m6RkpfBMVv8sQzW.png"></p>
<p><img src="/../../assets/UI5uP9wrA7MOfQZ.png"></p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/1df1/" rel="prev" title="MyBatisPlus">
                  <i class="fa fa-angle-left"></i> MyBatisPlus
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/375f/" rel="next" title="Oracle">
                  Oracle <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>





  <a target="_blank" rel="noopener" href="https://zxalive.com" class="special-link">新站点zxalive.com</a>


</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">zhangxin</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">1.8m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">26:53</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
